<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sukanya Samriddhi Yojana (SSY) Maturity Calculator</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding-bottom: 80px;
      transition: background-color 0.3s, color 0.3s;
      background-color: #121212;
      color: #f0f0f0;
    }
    body.light-mode {
      background-color: #f8f9fa;
      color: #212529;
    }
    #themeToggle {
      position: fixed;
      top: 1rem;
      right: 1rem;
      background: none;
      border: none;
      font-size: 1.7rem;
      cursor: pointer;
      color: #ff6600;
      z-index: 1000;
    }
    .container {
      max-width: 600px;
      padding: 1rem 1.5rem 4rem 1.5rem;
      margin: auto;
    }
    label span.tooltip-icon {
      margin-left: 6px;
      color: #ff6600;
      cursor: pointer;
      font-weight: 700;
      position: relative;
      display: inline-block;
    }
    label span.tooltip-icon:hover::after {
      content: attr(title);
      position: absolute;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      background-color: #333;
      color: #fff;
      padding: 6px 8px;
      border-radius: 4px;
      white-space: nowrap;
      font-size: 0.85rem;
      opacity: 1;
      pointer-events: none;
      z-index: 100;
    }
    label span.tooltip-icon::after {
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    .faq-item button {
      width: 100%;
      background: none;
      border: none;
      padding: 0.75rem;
      font-weight: 600;
      cursor: pointer;
      color: inherit;
      border-bottom: 1px solid #ccc;
      transition: background-color 0.3s;
      text-align: left;
    }
    .faq-answer {
      display: none;
      padding: 0 0.75rem 0.75rem;
      border-left: 3px solid #ff6600;
    }
    .faq-answer.show {
      display: block;
    }
    #shareSection {
      margin-top: 1.5rem;
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
    }
    #shareSection a,
    #shareSection button {
      flex: 1 1 auto;
      min-width: 100px;
      text-align: center;
    }
    footer {
  text-align: center;
  padding: 0.5rem 0;
  background-color: rgba(255, 102, 0, 0.15);
  color: #ff6600;
  font-weight: 600;
  font-size: 0.9rem;
  margin-top: 2rem;
    }
  </style>
</head>
<body class="dark-mode">
  <button id="themeToggle" title="Toggle theme">üåô</button>
  <main class="container">
    <h1 class="text-center mb-4">Sukanya Samriddhi Yojana (SSY) Maturity Calculator</h1>

    <form id="ssyForm" novalidate>
      <div class="mb-3">
        <label for="currentBalance" class="form-label">
          Current Balance (‚Çπ)
          <span class="tooltip-icon" title="Existing amount in the account">‚ìò</span>
        </label>
        <input type="number" id="currentBalance" class="form-control" min="0" value="0" required />
      </div>

      <div class="mb-3">
        <label for="investmentAmount" class="form-label">
          Investment Amount (‚Çπ)
          <span class="tooltip-icon" title="Monthly max ‚Çπ12,500, Yearly max ‚Çπ1,50,000">‚ìò</span>
        </label>
        <input type="number" id="investmentAmount" class="form-control" min="0" required />
      </div>

      <fieldset class="mb-3" id="investmentTypeFieldset">
        <legend class="form-label">Investment Type</legend>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="investmentType" id="monthly" value="monthly" checked />
          <label class="form-check-label" for="monthly">Monthly</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="investmentType" id="yearly" value="yearly" />
          <label class="form-check-label" for="yearly">Yearly</label>
        </div>
      </fieldset>

      <div class="mb-3">
        <label for="startYear" class="form-label">Account Start Year</label>
        <input type="number" id="startYear" class="form-control" min="2000" max="2099" value="2020" required />
      </div>

      <div class="mb-3">
        <label for="investmentYears" class="form-label">Years to Invest (Max 15)</label>
        <input type="number" id="investmentYears" class="form-control" min="0" max="15" value="15" required />
      </div>

      <div class="mb-3">
        <label for="interestRate" class="form-label">Interest Rate (%)</label>
        <input type="number" id="interestRate" class="form-control" step="0.01" value="8.2" required />
      </div>

      <button type="submit" class="btn btn-primary w-100">Calculate</button>
    </form>

    <section id="results" class="mt-4" style="display:none;">
      <h2 class="h5">Results</h2>
      <p id="summary" aria-live="polite"></p>
      <ul id="detailedResults" class="mb-3"></ul>
      <canvas id="growthChart" height="140"></canvas>

      <div id="shareSection" class="mt-4">
        <a id="whatsappShare" class="btn btn-success" target="_blank" rel="noopener">üì± WhatsApp</a>
        <a id="xShare" class="btn btn-dark" target="_blank" rel="noopener">ùïè Share</a>
        <button id="downloadResult" class="btn btn-secondary">‚¨áÔ∏è Download Results</button>
      </div>
    </section>

    <section class="mt-5" aria-label="Frequently Asked Questions">
      <h2 class="h5 mb-3">FAQs</h2>

      <div class="faq-item">
        <button aria-controls="faq1" type="button">What is Sukanya Samriddhi Yojana (SSY)?</button>
        <div id="faq1" class="faq-answer">
          Sukanya Samriddhi Yojana (SSY) is a government-backed savings scheme launched to encourage parents to save for their girl child's future education and marriage. It offers attractive interest rates along with tax benefits under Section 80C.
        </div>
      </div>

      <div class="faq-item">
        <button aria-controls="faq2" type="button">Who is eligible to open an SSY account?</button>
        <div id="faq2" class="faq-answer">
          A parent or guardian can open an SSY account in the name of their girl child below 10 years of age. Only one account is allowed per girl child.
        </div>
      </div>

      <div class="faq-item">
        <button aria-controls="faq3" type="button">What is the tenure and maturity period of SSY?</button>
        <div id="faq3" class="faq-answer">
          The account matures 21 years from the date of opening or upon the marriage of the girl after she turns 18 years, whichever is earlier.
        </div>
      </div>

      <div class="faq-item">
        <button aria-controls="faq4" type="button">What are the deposit limits?</button>
        <div id="faq4" class="faq-answer">
          Minimum deposit is ‚Çπ250 per year. Maximum deposits allowed are ‚Çπ1,50,000 per year (or ‚Çπ12,500 per month if depositing monthly). Deposits can be made in lump sum or installments.
        </div>
      </div>

      <div class="faq-item">
        <button aria-controls="faq5" type="button">What is the interest rate and how is it calculated?</button>
        <div id="faq5" class="faq-answer">
          The interest rate is set by the government quarterly and is compounded annually. Interest is calculated on the minimum balance between the 5th and last day of each month.
        </div>
      </div>

      <div class="faq-item">
        <button aria-controls="faq6" type="button">Can the account be closed early?</button>
        <div id="faq6" class="faq-answer">
          Partial or full withdrawal before maturity is allowed only under specific circumstances such as higher education or marriage of the girl after she reaches 18 years of age.
        </div>
      </div>

      <div class="faq-item">
        <button aria-controls="faq7" type="button">Are the deposits and interest tax-free?</button>
        <div id="faq7" class="faq-answer">
          Yes. Deposits qualify for deduction under Section 80C of the Income Tax Act, and the interest earned is tax-free.
        </div>
      </div>
    </section>
  </main>

  <footer>Made with ‚òï by Lenny Rajan</footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    const form = document.getElementById('ssyForm');
    const summary = document.getElementById('summary');
    const detailedResults = document.getElementById('detailedResults');
    const chartCanvas = document.getElementById('growthChart');
    const shareSection = document.getElementById('shareSection');
    const faqButtons = document.querySelectorAll('.faq-item button');
    const themeToggle = document.getElementById('themeToggle');
    const investmentTooltip = document.querySelector('label[for="investmentAmount"] .tooltip-icon');
    let chart;

    // Update tooltip on investment type change
    function updateTooltip() {
      const type = document.querySelector('input[name="investmentType"]:checked').value;
      if (type === 'monthly') {
        investmentTooltip.title = "Monthly max ‚Çπ12,500";
      } else {
        investmentTooltip.title = "Yearly max ‚Çπ1,50,000";
      }
    }
    document.querySelectorAll('input[name="investmentType"]').forEach(radio => {
      radio.addEventListener('change', updateTooltip);
    });
    updateTooltip();

    // Theme toggle logic
    themeToggle.addEventListener('click', () => {
      document.body.classList.toggle('light-mode');
      document.body.classList.toggle('dark-mode');
      themeToggle.textContent = document.body.classList.contains('light-mode') ? '‚òÄÔ∏è' : 'üåô';
    });

    // FAQ toggle logic
    faqButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        const answer = document.getElementById(btn.getAttribute('aria-controls'));
        answer.classList.toggle('show');
      });
    });

    // Calculation and chart logic
    form.addEventListener('submit', (e) => {
      e.preventDefault();

      const currentBalance = Math.max(0, parseFloat(document.getElementById('currentBalance').value) || 0);
      const investmentAmountRaw = Math.max(0, parseFloat(document.getElementById('investmentAmount').value) || 0);
      const investmentType = document.querySelector('input[name="investmentType"]:checked').value;
      const interestRate = parseFloat(document.getElementById('interestRate').value) || 0;
      const startYear = Math.min(2099, Math.max(2000, parseInt(document.getElementById('startYear').value) || new Date().getFullYear()));
      const investmentYears = Math.min(15, Math.max(0, parseInt(document.getElementById('investmentYears').value) || 0));

      // Validate investment amount limits
      const monthlyMax = 12500;
      const yearlyMax = 150000;
      if ((investmentType === 'monthly' && investmentAmountRaw > monthlyMax) ||
          (investmentType === 'yearly' && investmentAmountRaw > yearlyMax)) {
        alert(`Investment amount exceeds max limit for ${investmentType} deposits.`);
        return;
      }

      // Compute annual investment based on type
      const annualInvestment = investmentType === 'monthly' ? investmentAmountRaw * 12 : investmentAmountRaw;

      const maturityYear = startYear + 21;
      const currentYear = new Date().getFullYear();
      const yearsLeft = maturityYear - currentYear;

      // Accumulators
      let total = currentBalance;
      let totalInvested = currentBalance;
      let totalInterest = 0;

      const yearlyBalances = [];
      const yearlyInterests = [];

      for (let i = 0; i < 21; i++) {
        if (i < investmentYears) {
          total += annualInvestment;
          totalInvested += annualInvestment;
        }
        const interestForYear = (total * interestRate) / 100;
        total += interestForYear;
        totalInterest += interestForYear;

        yearlyBalances.push(total.toFixed(2));
        yearlyInterests.push(totalInterest.toFixed(2));
      }

      // Update summary and detailed results
      summary.textContent = `Estimated maturity amount by ${maturityYear} is ‚Çπ${Math.round(total).toLocaleString()}.`;

      detailedResults.innerHTML = `
        <li><strong>Years Left to Maturity:</strong> ${yearsLeft > 0 ? yearsLeft : 0}</li>
        <li><strong>Maturity Year:</strong> ${maturityYear}</li>
        <li><strong>Total Invested Amount:</strong> ‚Çπ${Math.round(totalInvested).toLocaleString()}</li>
        <li><strong>Total Interest Earned:</strong> ‚Çπ${Math.round(totalInterest).toLocaleString()}</li>
        <li><strong>Total Maturity Amount:</strong> ‚Çπ${Math.round(total).toLocaleString()}</li>
      `;

      // Render chart
      if (chart) chart.destroy();

      chart = new Chart(chartCanvas, {
        type: 'line',
        data: {
          labels: Array.from({length:21}, (_, i) => startYear + i),
          datasets: [
            {
              label: 'Total Balance (‚Çπ)',
              data: yearlyBalances,
              borderColor: '#ff6600',
              backgroundColor: 'rgba(255, 102, 0, 0.2)',
              tension: 0.3,
              fill: true,
            },
            {
              label: 'Interest Earned (‚Çπ)',
              data: yearlyInterests,
              borderColor: '#007bff',
              backgroundColor: 'rgba(0, 123, 255, 0.2)',
              tension: 0.3,
              fill: true,
            }
          ]
        },
        options: {
          responsive: true,
          plugins: { legend: { position: 'top' } },
          scales: {
            y: {
              ticks: {
                callback: value => '‚Çπ' + Number(value).toLocaleString()
              },
              beginAtZero: true
            }
          }
        }
      });

      // Show share section
      shareSection.style.display = 'flex';

      const shareText = `SSY Maturity by ${maturityYear}: ‚Çπ${Math.round(total).toLocaleString()}`;
      const shareURL = encodeURIComponent(window.location.href);

      document.getElementById('whatsappShare').href = `https://wa.me/?text=${encodeURIComponent(shareText)}%20${shareURL}`;
      document.getElementById('xShare').href = `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText)}&url=${shareURL}`;

      // Show results section
      document.getElementById('results').style.display = 'block';
    });

    // Download results button logic
    document.getElementById('downloadResult').addEventListener('click', () => {
      const resultSection = document.getElementById('results');
      const shareButtonsContainer = document.getElementById('shareSection');

      // Hide the share buttons visually but keep layout stable
      shareButtonsContainer.style.visibility = 'hidden';

      // Force dark mode colors for capture
      const originalBg = resultSection.style.backgroundColor;
      const originalColor = resultSection.style.color;

      resultSection.style.backgroundColor = '#121212';
      resultSection.style.color = '#f0f0f0';

      html2canvas(resultSection, { scale: 2 }).then(canvas => {
        // Restore styles
        resultSection.style.backgroundColor = originalBg;
        resultSection.style.color = originalColor;
        shareButtonsContainer.style.visibility = 'visible';

        const link = document.createElement('a');
        link.download = 'ssy-maturity-summary.png';
        link.href = canvas.toDataURL('image/png');
        link.click();
      });
    });
  </script>
</body>
</html>
